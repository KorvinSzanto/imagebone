!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a){!function(b){"use strict";b.Imagebone=a("./lib/main.js")}(window)},{"./lib/main.js":6}],2:[function(a,b){b.exports=function(){return a("./Class.js").extend({init:function(a,b,c){var d=new Image,e=this;return this.set("image",d).set("given_image",a).set("offset",{x:0,y:0}).set("padding",5).set("passed_width",b).set("passed_height",c).set("dragger_dragging",!1).set("image_dragging",!1).set("dragger_hovered",!1).set("image_hovered",!1).set("drag_start",{x:0,y:0}),d.onload=function(){e.initializeCanvas()},d.src=a.src,this},initializeCanvas:function(){var b=a("./Context.js"),c=this;this.set("canvas",document.createElement("canvas")).set("context",new b(this.get("canvas").getContext("2d"))).set("width",this.getGivenImage().width||this.getImage().width).set("height",this.getGivenImage().height||this.getImage().height).set("initial_width",this.getWidth()).set("initial_height",this.getHeight()).set("canvas_width",this.getWidth()).set("canvas_height",this.getHeight()).set("ratio",window.devicePixelRatio||1);var d=this.getCanvasWidth(),e=this.getCanvasHeight(),f=!1;return this.getPassedWidth()&&(d=this.getPassedWidth(),f=!0),this.getPassedHeight()&&(e=this.getPassedHeight(),f=!0),f&&this.resizeCanvas(d,e),window.document.addEventListener("mousemove",function(){c.handleMouseMove.apply(c,arguments)}),window.document.addEventListener("mouseup",function(){c.handleMouseUp.apply(c,arguments)}),this.getCanvas().addEventListener("mousedown",function(){c.handleMouseDown.apply(c,arguments)}),this.getGivenImage().parentNode.replaceChild(this.getCanvas(),this.getGivenImage()),this.renderSize().render()},renderSize:function(){var a=this.getCanvasWidth()+5*this.getPadding(),b=this.getCanvasHeight()+5*this.getPadding();return this.getCanvas().width=a*this.getRatio(),this.getCanvas().height=b*this.getRatio(),this.getCanvas().style.width=a+"px",this.getCanvas().style.height=b+"px",this},clearCanvas:function(){var a=this.getCanvas(),b=this.getContext();return a.width=a.width,b.setFillColor("white").fillRect(0,0,this.getCanvasWidth(),this.getCanvasHeight()),this},render:function(){return this.clearCanvas().drawBackground().drawImage().drawForeground()},redraw:function(){return this.renderSize().render()},drawBackground:function(){var a,b,c,d,e,f=10,g=Math.ceil(this.getCanvasWidth()/f),h=Math.ceil(this.getCanvasHeight()/f),i=this.getContext();for(i.setFillColor("#eee"),a=g;a--;)for(b=h;b--;)c=b%2?a%2===0:a%2!==0,c&&(d=f,e=f,i.fillRect(a*f,b*f,d,e));return this},drawImage:function(){var a=this.getContext();return a.drawImage(this.getImage(),this.getOffset().x,this.getOffset().y,this.getWidth(),this.getHeight()),this},drawForeground:function(){var a=this.getContext();return a.setFillColor("white").fillRect(this.getCanvasWidth(),0,6*this.getPadding(),this.getCanvasHeight()+6*this.getPadding()).fillRect(0,this.getCanvasHeight(),this.getCanvasWidth()+6*this.getPadding(),6*this.getPadding()),this.drawBottomSize().drawRightSize().drawDragHandle()},drawBottomSize:function(){var a,b=this.getContext().getContext(),c=this.getCanvasWidth();return b.font=12*this.getRatio()+'px "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif',b.textBaseline="middle",b.textAlign="center",a=b.measureText(c).width/this.getRatio(),this.getContext().setLineWidth(1).setStrokeColor("#333").setFillColor("rgb(100,0,100)").moveTo(1,this.getCanvasHeight()+this.getPadding()).addLine(0,2*this.getPadding()).addMove(0,-this.getPadding()).addLine((-2+this.getCanvasWidth()-a-this.getPadding())/2,0).addMove(a+this.getPadding(),0).lineTo(this.getCanvasWidth(),this.getCanvasHeight()+2*this.getPadding()).addMove(0,-this.getPadding()).addLine(0,2*this.getPadding()).stroke().fillText(c,this.getCanvasWidth()/2,this.getCanvasHeight()+2*this.getPadding()),this},drawRightSize:function(){var a,b=this.getContext().getContext(),c=this.getCanvasHeight();return b.font=12*this.getRatio()+'px "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif',b.textBaseline="middle",b.textAlign="center",a=b.measureText(c).width/this.getRatio(),this.getContext().setLineWidth(1).setStrokeColor("#333").setFillColor("rgb(100,0,100)").moveTo(this.getCanvasWidth()+this.getPadding(),1).addLine(2*this.getPadding(),0).addMove(-this.getPadding(),0).addLine(0,(-2+this.getCanvasHeight()-a-this.getPadding())/2).addMove(0,a+1.5*this.getPadding()).lineTo(this.getCanvasWidth()+2*this.getPadding(),this.getCanvasHeight()).addMove(-this.getPadding(),0).addLine(2*this.getPadding(),0).stroke().restore(),b.save(),b.translate(0,0),b.rotate(-Math.PI/2),b.textAlign="center",this.getContext().fillText(c,-this.getCanvasHeight()/2-this.getPadding()/2,this.getCanvasWidth()+2*this.getPadding()),b.restore(),this},drawDragHandle:function(){return this.getContext().save().setFillColor("#333").translate(this.getCanvasWidth()+.5*this.getPadding(),this.getCanvasHeight()+.5*this.getPadding()).fillRect(1*this.getPadding(),1*this.getPadding(),2,2).fillRect(1*this.getPadding(),2*this.getPadding(),2,2).fillRect(2*this.getPadding(),1*this.getPadding(),2,2).fillRect(2*this.getPadding(),2*this.getPadding(),2,2)},resizeCanvas:function(a,b){var c=this.getCanvasWidth(),d=this.getCanvasHeight();return a=Math.max(a,1),b=Math.max(b,1),this.getOffset().x-=(c-a)/2,this.getOffset().y-=(d-b)/2,this.set("canvas_width",a).set("canvas_height",b)},normalizeEvent:function(a){return"undefined"==typeof a.pageX&&(a.pageX=a.clientX+window.document.body.scrollLeft+window.document.documentElement.scrollLeft,a.pageY=a.clientY+window.document.body.scrollTop+window.document.documentElement.scrollTop),a},handleMouseMove:function(a){if(this.normalizeEvent(a),this.getImageDragging()||this.getDraggerDragging())this.getImageDragging()?(this.setOffset({x:this.getOffsetStart().x+a.pageX-this.getDragStart().x,y:this.getOffsetStart().y+a.pageY-this.getDragStart().y}),this.render()):this.getDraggerDragging()&&(this.resizeCanvas(this.getSizeStart().width+a.pageX-this.getDragStart().x,this.getSizeStart().height+a.pageY-this.getDragStart().y),this.renderSize().render());else{var b={x:this.getCanvas().offsetLeft+this.getCanvasWidth()+this.getPadding(),y:this.getCanvas().offsetTop+this.getCanvasHeight()+this.getPadding(),size:2*this.getPadding()};a.pageX>b.x&&a.pageX<b.x+b.size&&a.pageY>b.y&&a.pageY<b.y+b.size?(this.getCanvas().style.cursor="grab",this.getCanvas().style.cursor||(this.getCanvas().style.cursor="-webkit-grab"),this.set("dragger_hovered",!0)):(this.getCanvas().style.cursor="",this.set("dragger_hovered",!1),b={x:this.getCanvas().offsetLeft+this.getOffset().x,y:this.getCanvas().offsetTop+this.getOffset().y,width:this.getWidth(),height:this.getHeight()},this.getOffset().x+this.getWidth()>this.getCanvasWidth()&&(b.width=this.getCanvasWidth()-this.getOffset().x),this.getOffset().y+this.getHeight()>this.getCanvasHeight()&&(b.height=this.getCanvasHeight()-this.getOffset().y),a.pageX>b.x&&a.pageX<b.x+b.width&&a.pageY>b.y&&a.pageY<b.y+b.height?(this.getCanvas().style.cursor="grab",this.getCanvas().style.cursor||(this.getCanvas().style.cursor="-webkit-grab"),this.set("image_hovered",!0)):(this.getCanvas().style.cursor="",this.set("image_hovered",!1)))}},handleMouseDown:function(a){return this.normalizeEvent(a),this.getImageHovered()?(this.set("image_dragging",!0),this.set("drag_start",{x:a.pageX,y:a.pageY}),this.set("offset_start",{x:this.getOffset().x,y:this.getOffset().y}),this.getCanvas().style.cursor="",this.getCanvas().style.cursor="grabbing",this.getCanvas().style.cursor||(this.getCanvas().style.cursor="-webkit-grabbing")):this.getDraggerHovered()&&(this.set("dragger_dragging",!0),this.set("drag_start",{x:a.pageX,y:a.pageY}),this.set("size_start",{width:this.getCanvasWidth(),height:this.getCanvasHeight()}),this.getCanvas().style.cursor="",this.getCanvas().style.cursor="grabbing",this.getCanvas().style.cursor||(this.getCanvas().style.cursor="-webkit-grabbing")),this},handleMouseUp:function(){return this.set("image_dragging",!1),this.set("dragger_dragging",!1),this.getCanvas().style.cursor="",this.getCanvas().style.cursor="grab",this.getCanvas().style.cursor||(this.getCanvas().style.cursor="-webkit-grab"),this}})}()},{"./Class.js":3,"./Context.js":4}],3:[function(a,b){b.exports=function(){var a={};return this.get=function(b){return a[b]},this.set=function(b,c){a[b]=c;var d=b.split("_").map(function(a){return a.substr(0,1).toUpperCase()+a.toLowerCase().substr(1)}),e="get"+d.join("");return"undefined"==typeof this[e]&&(this[e]=function(){return this.get(b)}),e="set"+d.join(""),"undefined"==typeof this[e]&&(this[e]=function(a){return this.set(b,a)}),this},this.init?this.init.apply(this,arguments):this},b.exports.extend=a("./extend.js")},{"./extend.js":5}],4:[function(a,b){b.exports=function(){return a("./Class.js").extend({init:function(a){return this.set("context",a).set("ratio",window.devicePixelRatio||1),this.save()},applyToContext:function(a,b){var c=this.getContext();return c[a].apply(c,b),this},save:function(){return this.applyToContext("save")},restore:function(){return this.applyToContext("restore"),this.applyToContext("restore")},scale:function(a){return a*this.getRatio()},adjust:function(a){return a=this.scale(a),1===this.getRatio()&&(a-=.5),a},scaledArguments:function(a){return a=Array.prototype.slice.call(a),a.map(function(a){return this.adjust(a)},this)},setStrokeColor:function(a){return this.getContext().strokeStyle=a,this},setFillColor:function(a){return this.getContext().fillStyle=a,this},setLineWidth:function(a){return this.getContext().lineWidth=this.scale(a),this},moveTo:function(a,b){return this.set("x",a).set("y",b),this.applyToContext("moveTo",this.scaledArguments(arguments))},lineTo:function(a,b){return this.set("x",a).set("y",b),this.applyToContext("lineTo",this.scaledArguments(arguments))},addLine:function(a,b){return a=this.getX()+a,b=this.getY()+b,this.lineTo(a,b)},addMove:function(a,b){return a=this.getX()+a,b=this.getY()+b,this.moveTo(a,b)},translate:function(){return this.applyToContext("translate",this.scaledArguments(arguments))},fillText:function(){var a=Array.prototype.slice.call(arguments),b=a.shift();return a=this.scaledArguments(a),this.applyToContext("fillText",[b].concat(a))},strokeText:function(){var a=Array.prototype.slice.call(arguments),b=a.shift();return a=this.scaledArguments(a),this.applyToContext("strokeText",[b].concat(a))},fillRect:function(a,b,c,d){var e=Array.prototype.slice.call(arguments);return a=this.scale(e.shift()),b=this.scale(e.shift()),c=this.scale(e.shift()),d=this.scale(e.shift()),this.applyToContext("fillRect",[a,b,c,d])},drawImage:function(){var a=Array.prototype.slice.call(arguments),b=a.shift(),c=this.adjust(a.shift()),d=this.adjust(a.shift()),e=this.scale(a.shift()),f=this.scale(a.shift());return this.applyToContext("drawImage",[b,c,d,e,f])},stroke:function(){return this.applyToContext("stroke",[])}})}()},{"./Class.js":3}],5:[function(a,b){b.exports=function(a,b){function c(a){if(a===Object(a))return[];if(Object.keys)return Object.keys(a);var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}function d(a,b,d){if(null===a)return a;if(a.length===+a.length)for(var e=0,f=a.length;f>e;e++)b.call(d,a[e],e,a);else for(var g=c(a),h=0,i=g.length;i>h;h++)b.call(d,a[g[h]],g[h],a);return a}function e(a){return d(Array.prototype.slice.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a}var f,g=this;f=a&&Object.prototype.hasOwnProperty.call(a,"constructor")?a.constructor:function(){return g.apply(this,arguments)},e(f,g,b);var h=function(){this.constructor=f};return h.prototype=g.prototype,f.prototype=new h,a&&e(f.prototype,a),f.__super__=g.prototype,f}},{}],6:[function(a,b){b.exports=function c(b,d,e){if("[object Array]"===Object.prototype.toString.call(b)||"[object HTMLCollection]"===Object.prototype.toString.call(b)||"[object NodeList]"===Object.prototype.toString.call(b)){var f=[];return Array.prototype.map.call(b,function(a){f.push(new c(a,d,e))}),f}if(void 0===this||!(this instanceof c))return new c(b,d,e);this.init&&this.init.apply(this,arguments);var g=a("./Canvas.js");this.canvas=new g(b,d,e)},b.exports.prototype.resize=function(a,b){return a===Object(a)&&(a=a.x,b=a.y),this.canvas.resizeCanvas(a,b).renderSize().render(),this}},{"./Canvas.js":2}]},{},[1]);
//# sourceMappingURL=imagebone.map
